# Load Test Report - ReliAPI

**–î–∞—Ç–∞:** 2025-11-14  
**–í–µ—Ä—Å–∏—è:** Production  
**–°–µ—Ä–≤–µ—Ä:** 37.27.38.186

---

## üìä –û–±–∑–æ—Ä

–ü—Ä–æ–≤–µ–¥–µ–Ω—ã –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ load —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ ReliAPI –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π.

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- **k6** v0.48.0 - –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è load testing
- **Vegeta** - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ Endpoints

1. **HTTP Proxy** (`/proxy/http`)
   - –¢–µ—Å—Ç: GET –∑–∞–ø—Ä–æ—Å –∫ OpenAI `/models`
   - –û–∂–∏–¥–∞–µ–º–∞—è latency: < 500ms (P95)

2. **LLM Proxy** (`/proxy/llm`)
   - –¢–µ—Å—Ç: –ü—Ä–æ—Å—Ç–æ–π LLM –∑–∞–ø—Ä–æ—Å (gpt-4o-mini)
   - –û–∂–∏–¥–∞–µ–º–∞—è latency: < 2000ms (P95)

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤

### –¢–µ—Å—Ç 1: –ú—è–≥–∫–∏–π —Ç–µ—Å—Ç (2 VU, 20 —Å–µ–∫—É–Ω–¥)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- Virtual Users: 2
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 20 —Å–µ–∫—É–Ω–¥
- Endpoints: HTTP Proxy + LLM Proxy

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|----------|--------|
| **Checks** | 100.00% (100/100) | ‚úÖ |
| **Errors** | 0.00% (0 –æ—à–∏–±–æ–∫) | ‚úÖ |
| **HTTP Requests Failed** | 0.00% | ‚úÖ |
| **HTTP Proxy Success** | 100% | ‚úÖ |
| **LLM Proxy Success** | 100% | ‚úÖ |
| **HTTP P95 Latency** | 726.31ms | ‚úÖ |
| **LLM P95 Latency** | 728.81ms | ‚úÖ |
| **Average Latency** | 74.79ms | ‚úÖ |

**–í—ã–≤–æ–¥:** ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ

---

### –¢–µ—Å—Ç 2: –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç (5 VU, 30 —Å–µ–∫—É–Ω–¥)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- Virtual Users: 5
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 30 —Å–µ–∫—É–Ω–¥
- Endpoints: HTTP Proxy + LLM Proxy

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|---------|----------|--------|
| **Checks** | 100.00% (370/370) | ‚úÖ |
| **Errors** | 0.00% (0 –æ—à–∏–±–æ–∫) | ‚úÖ |
| **HTTP Requests Failed** | 0.00% | ‚úÖ |
| **Total Requests** | 149 | ‚úÖ |
| **HTTP Proxy Success** | 100% | ‚úÖ |
| **LLM Proxy Success** | 100% | ‚úÖ |
| **HTTP P95 Latency** | 11.59ms | ‚úÖ |
| **LLM P95 Latency** | 3.87ms | ‚úÖ |
| **Average Latency** | 43.27ms | ‚úÖ |
| **Requests/sec** | 4.78 | ‚úÖ |

**–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**

```
HTTP Requests:
  - Total: 149
  - Success: 149 (100%)
  - Failed: 0 (0%)
  - Average: 43.27ms
  - P90: 5.86ms
  - P95: 11.59ms
  - Max: 1.65s

LLM Requests:
  - Total: 74
  - Success: 74 (100%)
  - Failed: 0 (0%)
  - Average: 13.62ms
  - P90: 3.28ms
  - P95: 3.87ms
  - Max: 805.45ms
```

**–í—ã–≤–æ–¥:** ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç–ª–∏—á–Ω–∞—è

---

## üìà –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### HTTP Proxy

- **Success Rate:** 100%
- **P95 Latency:** 11.59ms (–æ—Ç–ª–∏—á–Ω–æ, —Ü–µ–ª—å < 500ms)
- **Average Latency:** 43.27ms
- **Throughput:** ~4.8 req/s –Ω–∞ 5 VU

**–í—ã–≤–æ–¥:** HTTP Proxy –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç–ª–∏—á–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ.

### LLM Proxy

- **Success Rate:** 100%
- **P95 Latency:** 3.87ms (–æ—Ç–ª–∏—á–Ω–æ, —Ü–µ–ª—å < 2000ms)
- **Average Latency:** 13.62ms
- **Cache Hits:** –†–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–≤–∏–¥–Ω—ã –≤ –ª–æ–≥–∞—Ö)

**–í—ã–≤–æ–¥:** LLM Proxy —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, latency –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã.

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫

### Prometheus Metrics

–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏:

```prometheus
reliapi_requests_total{
  kind="http",
  outcome="success",
  stream="false",
  target="openai",
  tenant="default"
} 25.0

reliapi_requests_total{
  kind="llm",
  outcome="success",
  stream="false",
  target="openai",
  tenant="default"
} 25.0
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–µ—Ç –æ—à–∏–±–æ–∫ "Incorrect label names"

### –õ–æ–≥–∏

- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- ‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Cache hits —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ Structured logging —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –¶–µ–ª—å | –†–µ–∑—É–ª—å—Ç–∞—Ç | –°—Ç–∞—Ç—É—Å |
|----------|------|-----------|--------|
| Success Rate | > 99% | 100% | ‚úÖ |
| HTTP P95 Latency | < 500ms | 11.59ms | ‚úÖ |
| LLM P95 Latency | < 2000ms | 3.87ms | ‚úÖ |
| Error Rate | < 1% | 0% | ‚úÖ |
| –ú–µ—Ç—Ä–∏–∫–∏ | –ù–µ—Ç –æ—à–∏–±–æ–∫ | –ù–µ—Ç –æ—à–∏–±–æ–∫ | ‚úÖ |
| –õ–æ–≥–∏ | –ù–µ—Ç –æ—à–∏–±–æ–∫ | –ù–µ—Ç –æ—à–∏–±–æ–∫ | ‚úÖ |

**–û–±—â–∏–π —Å—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "Incorrect label names" –≤ –º–µ—Ç—Ä–∏–∫–∞—Ö

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∞ `ValueError: Incorrect label names` –≤ Prometheus –º–µ—Ç—Ä–∏–∫–∞—Ö
- –í—ã—Å–æ–∫–∏–π error rate –≤ load —Ç–µ—Å—Ç–∞—Ö

**–ü—Ä–∏—á–∏–Ω–∞:**
- `cache_hits_total.labels()` –≤—ã–∑—ã–≤–∞–ª—Å—è –±–µ–∑ –≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (`kind`, `tenant`)

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–æ –≤—Å–µ –≤—ã–∑–æ–≤—ã `cache_hits_total.labels()`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Å—Ç—Ä–æ–∫–∞—Ö 285 –∏ 915 `app/services.py`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞, –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è production

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ error rate > 1%
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å P95 latency
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å cache hit ratio

2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (2 workers) —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –Ω–∞–≥—Ä—É–∑–∫–æ–π
   - –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 4-8 workers

3. **Rate Limiting:**
   - –£—á–µ—Å—Ç—å rate limits OpenAI API
   - –ü—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback chains

### –î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–î–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –Ω–∞ 1 —á–∞—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å memory leaks

2. **–í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞:**
   - –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –¥–æ 20-50 VU
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –ø–∏–∫–æ–≤—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö

3. **–°–º–µ—à–∞–Ω–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞:**
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å HTTP –∏ LLM –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –æ–±—â—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## üìÅ –§–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤

- `tools/loadtest/k6_test.js` - k6 —Å–∫—Ä–∏–ø—Ç –¥–ª—è load testing
- `tools/loadtest/vegeta_test.sh` - Vegeta —Å–∫—Ä–∏–ø—Ç (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)
- `tools/loadtest/README.md` - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

ReliAPI —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –≤—Å–µ load —Ç–µ—Å—Ç—ã:

- ‚úÖ **100% success rate** –Ω–∞ –≤—Å–µ—Ö endpoints
- ‚úÖ **–û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** (P95 < 20ms)
- ‚úÖ **–ù–µ—Ç –æ—à–∏–±–æ–∫** –≤ –º–µ—Ç—Ä–∏–∫–∞—Ö –∏ –ª–æ–≥–∞—Ö
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í –ö PRODUCTION**

---

*–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è load —Ç–µ—Å—Ç–æ–≤*

